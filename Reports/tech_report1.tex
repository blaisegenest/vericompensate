\documentclass{llncs}
\pagestyle{plain}

%\usepackage[latin9]{inputenc}
%\usepackage[T1]{fontenc}
\usepackage{float}
\usepackage{wrapfig}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{tabularx}
\captionsetup{compatibility=false}
% \usepackage{esint}
\usepackage{array}
\usepackage{epstopdf}
\usepackage{placeins}
\usepackage{pgfplots}
\usepackage{url}
\usepackage{tikz}
\usepackage{calc}
\usepackage[linesnumbered,ruled,vlined]{algorithm2e}
\usetikzlibrary{positioning, arrows.meta,calc}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\vx}{\boldsymbol{x}}
\newcommand{\vy}{\boldsymbol{y}}
\newcommand{\vW}{\boldsymbol{W}}
\newcommand{\vz}{\boldsymbol{z}}
\newcommand{\vb}{\boldsymbol{bias}}
\newcommand{\val}{{\textrm{value}}}
\newcommand{\Val}{{\textrm{value}}}
\newcommand{\MILP}{{\textrm{MILP}}}
\newcommand{\LP}{{\textrm{LP}}}

\newcommand{\UB}{\mathrm{UB}}
\newcommand{\LB}{\mathrm{LB}}
\newcommand{\ub}{\mathrm{ub}}
\newcommand{\lb}{\mathrm{lb}}
\newcommand{\B}{\mathrm{B}}

\newcommand{\CMP}{{\textrm{CMP}}\ }


\newcommand{\toolname}{\ensuremath{\mathsf{Comp}}}






%\usepackage{amsmath, amsthm, amssymb, amsfonts}
%\newtheorem{theorem}{Theorem}
%\newtheorem{lemma}{Lemma}
%\newtheorem{corollary}{Corollary}
%\theoremstyle{definition}
%\newtheorem{definition}{Definition}



\newcommand{\ReLU}{\mathrm{ReLU}}



\title{Technical Report}
\date{}

\begin{document}
	
\maketitle

\section*{Introduction}

Only formal experiments will be recorded. Pre-debugging will not be recorded unless necessary.

\section{February 15 experiments}

\subsection{Rerun the gamma test}

This experiment is to rerun the interrupted experiment on14 February night.

\vspace*{1ex}

The running code's file name is \verb*|DiamondLipschitz_all_layers_test_LP_use_bound.py|. And the output file name is \verb*|Gamma_V0p2_all_layers_MILP_usebounds1.txt|. It is to compute the gamma ($\gamma$). It is based on the new hyperplane constraints, use MILP model to compute the gamma from layer 5 to layer 5.


\subsubsection*{Parameters.}

\begin{itemize}
	\item \emph{Experiments Id}: 021500102024
	
	\item\emph{Network:} 6x100 MNIST normal. 
	
	\item\emph{Image:} 144 (meaningless).
	
	\item\emph{Epsilon $\varepsilon$:} 0.001.
	
	\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.
	
	\item\emph{Open $\ReLU$ number:} 17 for layer 3, 23 for layer 5, 35 for layer 7 and 9. 
	
	\item\emph{Processes:} 20 processes in parallel.
	
	\item\emph{Read binary files:} \verb*|dict_bounds_gurobi_alphabeta_2024021401.b|; this file stores the alpha beta of nodes of all layers for the same network. \verb*|dict_bounds_gurobi_gamma_2024021501.b|; this file stores the gamma of nodes up to layer 3, computed by the same code.
\end{itemize}







\subsubsection*{Technical Sketch.}


The new group of hyperplane constraints is as follows: \begin{align*}
	&\hat{x}_i - \hat{x}_i' \leq \frac{1}{2} (x_i-x_i') + \frac{1}{2} \gamma_i\\
	&\hat{x}_i' - \hat{x}_i \leq \frac{1}{2} (x_i'-x_i) + \frac{1}{2}\gamma_i
\end{align*} Here, $x_i$ and $x_i'$ are the two variables corresponding to a node $i$ in previous layer, and $\gamma_i$ is the $\gamma$ of node $i$ computed in previous layer; $\hat{x}_i,\hat{x}_i'$ are variables after $\ReLU$ function.

One characteristic is that the constraints do not reply on $\alpha$ or $\beta$. So even with $\alpha,\beta$ of very poor quality, this group of constraints can work.


This running recover the last layer: in early experiments, the last layer is modified to 9 nodes. Now it is recovered to 10 nodes. Because of this, the Bootstrap data of last layer is computed.

\subsubsection*{Results.}

No result.

It seems that open-23-node for layer 5 with new hyperplane constraints is not good, at least with respect to the time cost: most nodes run out of 600s x 12, and this means we need 10 hours to do the whole layer 5.

Let's try a fewer number of open $\ReLU$ nodes.


\subsection{Rerun the gamma test: layer 5 with changed parameters}

This experiments shares some setting as previous one. 

\subsubsection*{Parameters.}

\begin{itemize}
	\item\emph{Experiments Id}: 021500202024

\item\emph{Network:} 6x100 MNIST normal. 

\item\emph{Image:} 144 (meaningless).

\item\emph{Epsilon $\varepsilon$:} 0.001.

\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.

\item\emph{Open $\ReLU$ number:} 17 for layer 5. 

\item\emph{Processes:} 20 processes in parallel.

\item\emph{Read binary files:} \verb*|dict_bounds_gurobi_alphabeta_2024021401.b|; this file stores the alpha beta of nodes of all layers for the same network. \verb*|dict_bounds_gurobi_gamma_2024021501.b|; this file stores the gamma of nodes up to layer 3, computed by the same code.
\end{itemize}


\subsubsection*{Technical Sketch.}

The same as previous experiments.

\subsubsection*{Results.}

\begin{itemize}
	\item \emph{Log:} \verb*|Gamma_V0p2_all_layers_MILP_usebounds1.txt|

	\item \emph{Total time:} 4779s.

	\item \emph{Key results:} $\gamma$ for layer 5 is 0.9922133701854773.
\end{itemize}


Open 17 nodes is OK, but we can still increase the number of open ReLU nodes for layer 5. Perhaps open 20 nodes is a good choice.



\subsection{Rerun the gamma test: layer 7,9 with changed parameters}

This experiments shares some setting as previous ones. 

\subsubsection*{Parameters.}

\begin{itemize}
	\item\emph{Experiments Id}: 021500302024
	
	\item\emph{Network:} 6x100 MNIST normal. 
	
	\item\emph{Image:} 144 (meaningless).
	
	\item\emph{Epsilon $\varepsilon$:} 0.001.
	
	\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.
	
	\item\emph{Open $\ReLU$ number:} 20 for layer 7 and 9. 
	
	\item\emph{Processes:} 20 processes in parallel.
	
	\item\emph{Read binary files:} \verb*|Diamond_record_6_100_dictionary_with_end_layer5_2024_02_15_11_40_01.b|; this file stores all alpha beta gamma of nodes of all layers for the same network (gamma is up to layer 5). 
\end{itemize}


\subsubsection*{Technical Sketch.}

The same as Experiments 021500202024.

\subsubsection*{Results.}

\begin{itemize}
	\item \emph{Log:} \verb*|Gamma_V0p2_all_layers_MILP_usebounds2.txt|
	
	\item \emph{Total time:} 14985.4s.
	
	\item \emph{Key results:} $\gamma$ for layer 7 is 4.177719108178739; $\gamma$ for layer 9 is 16.878953032158446.
\end{itemize}



\subsection{Gamma test for robust 5x100 using MILP}

This experiment is to rerun the interrupted experiment on14 February night.

\vspace*{1ex}

The running code's file name is \verb*|DiamondLipschitz_all_layers_test_LP_DiffAI.py|. The output file name is \verb*|Gamma_V0p2_all_layers_5x100_robust_MILP.txt| and \verb*|Diamond_record_5_100_dictionary_with_end_layer9_2024_02_15_19_29_17.b|. It is to compute the gamma ($\gamma$). It is based on the new hyperplane constraints, use MILP model to compute the gamma of robust 5x100 from layer 1 to layer 9.


\subsubsection*{Parameters.}

\begin{itemize}
	\item \emph{Experiments Id}: 021500402024
	
	\item\emph{Network:} 6x100 MNIST robust. 
	
	\item\emph{Image:} 144 (meaningless).
	
	\item\emph{Epsilon $\varepsilon$:} 0.001.
	
	\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.
	
	\item\emph{Open $\ReLU$ number:} 17 for layer 3, 23 for layer 5, 35 for layer 7 and 9. 
	
	\item\emph{Processes:} 20 processes in parallel.
	
	\item\emph{Read binary files:} No read file. I planned to read alpha-beta data, but the pre-computed alpha-beta data seems to have some problems, so I use the version that will compute the alpha beta during the running.
\end{itemize}







\subsubsection*{Technical Sketch.}


The same as other experiments today.

\subsubsection*{Results.}


\begin{itemize}
	\item \emph{Log:} \verb*|Gamma_V0p2_all_layers_5x100_robust_MILP.txt|
	
	\item \emph{Total time:} 19270.8s.
	
	\item \emph{Key results:} $\gamma$ for layer 1 to layer 9: 0.006884580440378905, 0.014342863034246162,
	0.034691083484486775, 0.09665049332723069,
	0.28105516604910674
\end{itemize}





\section{February 16 experiments}



\subsection{Rerun the gamma test: layer 3 with new settings}

 

\subsubsection*{Parameters.}

\begin{itemize}
	\item\emph{Experiments Id}: 021600102024
	
	\item\emph{Network:} 6x100 MNIST normal. 
	
	\item\emph{Image:} 144 (meaningless).
	
	\item\emph{Epsilon $\varepsilon$:} 0.001.
	
	\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.
	
	\item\emph{Open $\ReLU$ number:} 
	
	\item\emph{Processes:} 20 processes in parallel.
	
	\item\emph{Read binary files:} 
\end{itemize}


\subsubsection*{Technical Sketch.}

The same as Feb 15's experiments.

\subsubsection*{Results.} No meaningful result. The $\gamma$ is still 0.24007008332521998.



\subsection{Seek the best open ReLU number for layer 3 for normal 5x100}

This experiment is to find the best open ReLU number for layer 3 normal 5x100 with new hyperplane constraints: previous open 17 node is based on old constraints.

\vspace*{1ex}

The running code's file name is \verb*|DiamondLipschitz_all_layers_test_LP_use_bound_seek_open_number.py|. And the partial output file name is \verb*|Gamma_5x100_normal_layer3_seek_openrelu.txt|.  It is based on the new hyperplane constraints, use MILP model to compute the gamma of layer 3 with different open ReLU numbers.

\subsubsection*{Parameters.}

\begin{itemize}
	\item\emph{Experiments Id}: 021600202024
	
	\item\emph{Network:} 6x100 MNIST normal. 
	
	\item\emph{Image:} 144 (meaningless).
	
	\item\emph{Epsilon $\varepsilon$:} 0.001.
	
	\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.
	
	\item\emph{Open $\ReLU$ number:} Open 15,18,21,24,27 ReLU nodes for each node.
	
	\item\emph{Processes:} 20 processes in parallel. Do node 0 to 19 each 5 cases.
	
	\item\emph{Read binary files:} Read \verb*|Diamond_record_6_100_dictionary_with_end_layer5_2024_02_15_11_40_01.b|; this file stores all alpha beta gamma of nodes of all layers for the same network (gamma is up to layer 5). 
\end{itemize}


\subsubsection*{Technical Sketch.}

Most is the same as Feb 15's experiments.

\subsubsection*{Results.}

Not finished before stop, but it is very obvious that 21 is the best among all 5 cases.



\subsection{Seek the best open ReLU number for layer 5 for normal 5x100}

This experiment is to find the best open ReLU number for layer 5 normal 5x100 with new hyperplane constraints. In addition, this test also compute the gamma data for layer 3 based on previous found best open number.

\vspace*{1ex}

The running code's file name is \verb*|DiamondLipschitz_all_layers_test_LP_use_bound_seek_open_number.py|. And the partial output file name is \verb*|Gamma_5x100_normal_layer5_seek_openrelu.txt|.  It is based on the new hyperplane constraints, use MILP model to compute the gamma of layer 5 with different open ReLU numbers.

\subsubsection*{Parameters.}

\begin{itemize}
	\item\emph{Experiments Id}: 021600302024
	
	\item\emph{Network:} 6x100 MNIST normal. 
	
	\item\emph{Image:} 144 (meaningless).
	
	\item\emph{Epsilon $\varepsilon$:} 0.001.
	
	\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.
	
	\item\emph{Open $\ReLU$ number:} Open 17,20,23,26,29 ReLU nodes for each node.
	
	\item\emph{Processes:} 20 processes in parallel. Do node 0 to 19 each 5 cases.
	
	\item\emph{Read binary files:} Read \verb*|Diamond_record_6_100_dictionary_with_end_layer5_2024_02_15_11_40_01.b|; this file stores all alpha beta gamma of nodes of all layers for the same network (gamma is up to layer 5). 
\end{itemize}


\subsubsection*{Technical Sketch.}

Most is the same as Feb 15's experiments.

\subsubsection*{Results.}

\begin{itemize}
	\item \emph{Log:} \verb*|Gamma_5x100_normal_layer5_seek_openrelu.txt|
	
	\item \emph{Total time:} 61891s.
	
	\item \emph{Key results:} $\gamma$ for different open number are 0.9664584160601942,
	0.9480190853777704,
	0.969433533659244,
	0.9832281749149849,
	0.9884851087698833. This means open 20 is the best among 5 choices.
	
	\item \emph{Binary data}: \verb*|Diamond_record_6_100_dictionary_with_end_layer3_2024_02_16_15_24_52.b| and \verb*|Diamond_record_6_100_dictionary_with_end_layer5_2024_02_16_15_24_52.b|. The first stores the gamma up to layer 3, and the second stores tests result of layer 5 in addition.
\end{itemize}


 



\section{February 17-18 experiments}



\subsection{Seek the best open ReLU number for layer 7 for normal 5x100}

This experiment is to find the best open ReLU number for layer 7 normal 5x100 with new hyperplane constraints. In addition, this test also compute the gamma data for layer 5 based on previous found best open number.

\vspace*{1ex}

The running code's file name is \verb*|DiamondLipschitz_all_layers_test_LP_use_bound_seek_open_number.py| (a copy for it is \verb*|DiamondLipschitz_all_layers_test_LP_use_bound_seek_open_number_layer7.py|). And the partial output file name is \verb*|Gamma_5x100_normal_layer7_seek_openrelu.txt|.  It is based on the new hyperplane constraints, use MILP model to compute the gamma of layer 5 with different open ReLU numbers.

\subsubsection*{Parameters.}

\begin{itemize}
	\item\emph{Experiments Id}: 021700102024
	
	\item\emph{Network:} 6x100 MNIST normal. 
	
	\item\emph{Image:} 144 (meaningless).
	
	\item\emph{Epsilon $\varepsilon$:} 0.001.
	
	\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.
	
	\item\emph{Open $\ReLU$ number:} Open 20, 24, 28, 32, 36 ReLU nodes for each node.
	
	\item\emph{Processes:} 20 processes in parallel. Do node 0 to 19 each 5 cases.
	
	\item\emph{Read binary files:} Read \verb*|Diamond_record_6_100_dictionary_with_end_layer3_2024_02_16_15_24_52.b|; this file stores all alpha beta gamma of nodes of all layers for the same network (gamma is up to layer 3 and is newly-computed). 
\end{itemize}


\subsubsection*{Technical Sketch.}

Most is the same as Feb 15's experiments.

\subsubsection*{Results.}

\begin{itemize}
	\item \emph{Log:} \verb*|Gamma_5x100_normal_layer7_seek_openrelu.txt|
	
	\item \emph{Total time:} 40866s.
	
	\item \emph{Key results:} $\gamma$ for different open number are 3.924847266202133,
	3.879966384915862,
	3.843735078541843,
	3.834229593178003,
	3.816831654178999. This means open 36 is the best among 5 choices.
	
	\item \emph{Binary data}: \verb*|Diamond_record_6_100_dictionary_with_end_layer5_2024_02_18_22_11_50.b| and \verb*|Diamond_record_6_100_dictionary_with_end_layer7_2024_02_18_22_11_50.b|. The first stores the gamma up to layer 5, and the second stores tests result of layer 7 in addition.
\end{itemize}



\subsection{Randomly choose open ReLU for layer 3 for normal 5x100}

This experiment is to test the random open ReLU nodes for layer 3 normal 5x100 with new hyperplane constraints.

\vspace*{1ex}

The running code's file name is \verb*|DiamondLipschitz_all_layers_test_LP_use_bound_seek_open_number.py| (a copy for it is \verb*|DiamondLipschitz_all_layers_test_LP_use_bound_seek_open_number_random.py|). And the partial output file name is \verb*|Gamma_5x100_normal_layer3_seek_openrelu_random.txt|.  It is based on the new hyperplane constraints, use MILP model to compute the gamma of layer 3 with different open ReLU numbers and nodes chosen randomly.

\subsubsection*{Parameters.}

\begin{itemize}
	\item\emph{Experiments Id}: 021700202024
	
	\item\emph{Network:} 6x100 MNIST normal. 
	
	\item\emph{Image:} 144 (meaningless).
	
	\item\emph{Epsilon $\varepsilon$:} 0.001.
	
	\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.
	
	\item\emph{Open $\ReLU$ number:} Open 15,18,21,24,27 ReLU nodes for each node, but choose open nodes randomly.
	
	\item\emph{Processes:} 20 processes in parallel. Do node 0 to 19 each 5 cases.
	
	\item\emph{Read binary files:} Read \verb*|Diamond_record_6_100_dictionary_with_end_layer3_2024_02_16_15_24_52.b|; this file stores all alpha beta gamma of nodes of all layers for the same network (gamma is up to layer 3 and is newly-computed). 
\end{itemize}


\subsubsection*{Technical Sketch.}

Most is the same as Feb 15's experiments.

\subsubsection*{Results.}

\begin{itemize}
	\item \emph{Log:} \verb*|Gamma_5x100_normal_layer3_seek_openrelu_random.txt|
	
	\item \emph{Total time:} 14072.
	
	\item \emph{Key results:} $\gamma$ for different open number are 0.28773090140361735,
	0.2804030901915068,
	0.2733447337312936,
	0.26386494446982417,
	0.2613191792848188. This is much worse than open node by our method.

\end{itemize}

\section{February 19 experiments}

\subsection{Randomly choose open ReLU for layer 5 for normal 5x100}

This experiment is to test the random open ReLU nodes for layer 5 normal 5x100 with new hyperplane constraints.

\vspace*{1ex}

The running code's file name is \verb*|DiamondLipschitz_all_layers_test_LP_use_bound_seek_open_number_random.py| (a copy for it is \verb*|DiamondLipschitz_all_layers_test_LP_use_bound_seek_open_number_random2.py|). And the partial output file name is \verb*|Gamma_5x100_normal_layer5_seek_openrelu_random.txt|.  It is based on the new hyperplane constraints, use MILP model to compute the gamma of layer 5 with different open ReLU numbers and nodes chosen randomly.

\subsubsection*{Parameters.}

\begin{itemize}
	\item\emph{Experiments Id}: 021900102024
	
	\item\emph{Network:} 6x100 MNIST normal. 
	
	\item\emph{Image:} 144 (meaningless).
	
	\item\emph{Epsilon $\varepsilon$:} 0.001.
	
	\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.
	
	\item\emph{Open $\ReLU$ number:} Open 17,20,23,26,29 ReLU nodes for each node, but choose open nodes randomly.
	
	\item\emph{Processes:} 20 processes in parallel. Do node 0 to 19 each 5 cases.
	
	\item\emph{Read binary files:} Read \verb*|Diamond_record_6_100_dictionary_with_end_layer3_2024_02_16_15_24_52.b|; this file stores all alpha beta gamma of nodes of all layers for the same network (gamma is up to layer 3 and is newly-computed). 
\end{itemize}


\subsubsection*{Technical Sketch.}

Most is the same as Feb 15's experiments.

\subsubsection*{Results.}

\begin{itemize}
	\item \emph{Log:} \verb*|Gamma_5x100_normal_layer5_seek_openrelu_random.txt| (from line 5776).
	
	\item \emph{Total time:} 11346.9s.
	
	\item \emph{Key results:} $\gamma$ for different open numbers are 1.1082117992614573    open 17
	1.0902650122404043     20
	1.0854613578404746     23
	1.0692115311756667     26
	1.055639230561528        29. This is much worse than open node by our method.
	
\end{itemize}



\section{February 21 experiments}

\subsection{Find best open ReLU for layer 3 for normal 5x100, new pure y-constraints}

This experiment is to find the best open ReLU number for layer 3 normal 5x100 with new pure-y constraints constraints.

\vspace*{1ex}

The running code's file name is \verb*|DiamondLipschitz_V0p3_test.py|. And the partial output file name is \verb*|DL_V0p3_find_open_number_layer3_0.txt,DL_V0p3_find_open_number_layer3_1.txt,DL_V0p3_find_open_number_layer3_2.txt,DL_V0p3_find_open_number_layer3_3.txt|.  It is based on the new pure y-constraints, use MILP model to compute the gamma of layer 3 with different open ReLU numbers.

\subsubsection*{Parameters.}

\begin{itemize}
	\item\emph{Experiments Id}: 022100102024
	
	\item\emph{Network:} 6x100 MNIST normal. 
	
	\item\emph{Image:} 144 (meaningless).
	
	\item\emph{Epsilon $\varepsilon$:} 0.001.
	
	\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.
	
	\item\emph{Open $\ReLU$ number:} Open 20,23,26,29,32 ReLU nodes for each node.
	
	\item\emph{Processes:} 20 processes in parallel. Do node 0 to 19 each 5 cases.
	
	\item\emph{Read binary files:} Read \verb*|Diamond_record_6_100_dictionary_with_end_layer3_2024_02_16_15_24_52.b|; this file stores all alpha beta gamma of nodes of all layers for the same network. 
\end{itemize}


\subsubsection*{Technical Sketch.}

We will use the following new constraints, and keep the old variables and constraints (will not use them at present).

The new constraints are: \begin{align*}
	\hat{y}_i \leq a \gamma_i \hspace*{2ex} &\wedge \hspace*{2ex}\hat{y} \geq y_i - a \gamma_i\\
	\hat{y}_i \geq (a-1) \gamma_i  \hspace*{2ex} &\wedge \hspace*{2ex} \hat{y} \leq y_i + (1-a) \gamma_i,
\end{align*} Here, $y_i$ is the variable that represents $x_i-x'_i$, $\hat{y}_i$ represents $\hat{x}_i-\hat{x}'_i$, $a$ is a binary variable, $\gamma_i$ is the upper bound of $x_i-x'_i$.



\subsubsection*{Results.}

\begin{itemize}
	\item \emph{Log:} \verb*|DL_V0p3_find_open_number_layer3_0.txt,DL_V0p3_find_open_number_layer3_1.txt,DL_V0p3_find_open_number_layer3_2.txt,DL_V0p3_find_open_number_layer3_3.txt|.
	
	\item \emph{Total time:} 
	
	\item \emph{Key results:} Due to some mistakes we only have open to 29 nodes. $\gamma$ for different open numbers are 
	
	0.2280277192602802          0.2303032016837368         open 20
	
	0.2168232231501058          0.21899023640990567      open 23
	
	0.20544377026809135        0.2103601628177343        open 26
	
     0.19510091588084752   0.20836893269039397   open 29
	
	 This is much better than previous methods.
	
\end{itemize}

\subsection{Compute the gamma of layer 3 for normal 5x100, new pure y-constraints}

This experiment is to  compute the gamma of layer 3 normal 5x100 with new pure-y constraints constraints.

\vspace*{1ex}

The running code's file name is \verb*|DiamondLipschitz_V0p3_test.py|. And the output file name is \verb*|DL_V0p3_layer3_open_27.txt|.  It is based on the new pure y-constraints, use MILP model to compute the gamma of layer 3 with open 27 ReLU numbers.

\subsubsection*{Parameters.}

\begin{itemize}
	\item\emph{Experiments Id}: 022100102024
	
	\item\emph{Network:} 6x100 MNIST normal. 
	
	\item\emph{Image:} 144 (meaningless).
	
	\item\emph{Epsilon $\varepsilon$:} 0.001.
	
	\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.
	
	\item\emph{Open $\ReLU$ number:} Open 27 ReLU nodes for each node.
	
	\item\emph{Processes:} 20 processes in parallel. 
	
	\item\emph{Read binary files:} Read \verb*|Diamond_record_6_100_dictionary_with_end_layer3_2024_02_16_15_24_52.b|; this file stores all alpha beta gamma of nodes of all layers for the same network. 
\end{itemize}


\subsubsection*{Technical Sketch.}

We will use the following new constraints, and keep the old variables and constraints (will not use them at present).

\subsubsection*{Results.}

\begin{itemize}
	\item \emph{Log:} \verb*|DL_V0p3_layer3_open_27.txt|.
	
	\item \emph{Total time:} 30740s.
	
	\item \emph{Key results:} The average gamma of this layer is:  0.20506045995399397
	
	The average solution for gamma of this layer is:  0.1998876293451762
	
	\item  \emph{Binary file:} \verb*|Diamond_record_6_100_dictionary_with_end_layer3_2024_02_21_13_58_49.b|. This file stores the gammas in this test.
	
\end{itemize}



\subsection{Find best open ReLU for layer 5 for normal 5x100, new pure y-constraints}

This experiment is to find the best open ReLU number for layer 5 normal 5x100 with new pure-y constraints constraints.

\vspace*{1ex}

The running code's file name is \verb*|DiamondLipschitz_V0p3_test.py|. And the partial output file name is \verb*|DL_V0p3_layer5_find_best_number.txt|.  It is based on the new pure y-constraints, use MILP model to compute the gamma of layer 5 with different open ReLU numbers.

\subsubsection*{Parameters.}

\begin{itemize}
	\item\emph{Experiments Id}: 022100202024
	
	\item\emph{Network:} 6x100 MNIST normal. 
	
	\item\emph{Image:} 144 (meaningless).
	
	\item\emph{Epsilon $\varepsilon$:} 0.001.
	
	\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.
	
	\item\emph{Open $\ReLU$ number:} Open 25,28,31, 34, 37 ReLU nodes for each node.
	
	\item\emph{Processes:} 20 processes in parallel. Do node 0 to 19 each 5 cases.
	
	\item\emph{Read binary files:} Read \verb*|Diamond_record_6_100_dictionary_with_end_layer3_2024_02_21_13_58_49.b|; this file stores all alpha beta gamma of nodes of all layers for the same network,and the data of gamma of layer 3 using the latest method. 
\end{itemize}


\subsubsection*{Technical Sketch.}

We will use the following new constraints, and keep the old variables and constraints (will not use them at present).

The new constraints are: \begin{align*}
	\hat{y}_i \leq a \gamma_i \hspace*{2ex} &\wedge \hspace*{2ex}\hat{y} \geq y_i - a \gamma_i\\
	\hat{y}_i \geq (a-1) \gamma_i  \hspace*{2ex} &\wedge \hspace*{2ex} \hat{y} \leq y_i + (1-a) \gamma_i,
\end{align*} Here, $y_i$ is the variable that represents $x_i-x'_i$, $\hat{y}_i$ represents $\hat{x}_i-\hat{x}'_i$, $a$ is a binary variable, $\gamma_i$ is the upper bound of $x_i-x'_i$.



\subsubsection*{Results.}

Not completed. So here is the summary of the partial results.

\begin{itemize}
	\item \emph{Log:} \verb*|DL_V0p3_layer5_find_best_number.txt|.
	
	\item \emph{Total time:} 
	
	\item \emph{Key results:}  $\gamma$ for different open numbers are 
	
	Open 25 
	Bound: 0.8382390973953313 , Solution: 0.8321314445556547 , Time: 306.77194131612777 2335.830235481262
	
	Open 28 
	Bound: 0.8147201914056824 , Solution: 0.8054690328829098 , Time: 1176.2175419330597 7200.522756814957
	
	Open 31 
	Bound: 0.7963056225858687 , Solution: 0.7818023933666046 , Time: 3502.1967465043067 7200.723284482956
	
	Open 34 
	Bound: 0.7945120282557274 , Solution: 0.7582789017028382 , Time: 5760.061596000194 7200.779401540756
	
	Open 37 (not finished) 
	Bound: 0.8022403621011988 , Solution: 0.7360574057164293 , Time: 4956.505218315125 7200.661721229553
	
	It seems that 34 is the best. In following experiments, we use open 33 node.
	
\end{itemize}






\subsection{Compute the gamma of layer 5 for normal 5x100, new pure y-constraints}

This experiment is to  compute the gamma of layer 5 normal 5x100 with new pure-y constraints constraints.

\vspace*{1ex}

The running code's file name is \verb*|DiamondLipschitz_V0p3_test.py|. And the output file name is \verb*|DL_V0p3_layer5_open_33_node_1.txt|.  It is based on the new pure y-constraints, use MILP model to compute the gamma of layer 5 with open 33 ReLU numbers.

\subsubsection*{Parameters.}

\begin{itemize}
	\item\emph{Experiments Id}: 022200302024
	
	\item\emph{Network:} 6x100 MNIST normal. 
	
	\item\emph{Image:} 144 (meaningless).
	
	\item\emph{Epsilon $\varepsilon$:} 0.001.
	
	\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.
	
	\item\emph{Open $\ReLU$ number:} Open 33 ReLU nodes for each node.
	
	\item\emph{Processes:} 20 processes in parallel. 
	
	\item\emph{Read binary files:} Read \verb*|Diamond_record_6_100_dictionary_with_end_layer3_2024_02_21_13_58_49.b|; this file stores all alpha beta gamma of nodes of all layers for the same network, and the gamma of layer 3 that is computed by new version.
\end{itemize}


\subsubsection*{Technical Sketch.}

We will use the following new constraints, and keep the old variables and constraints (will not use them at present).

\subsubsection*{Results.}

\begin{itemize}
	\item \emph{Log:} \verb*|DL_V0p3_layer5_open_33_node_1.txt|.
	
	\item \emph{Total time:} 26809.2s.
	
	\item \emph{Key results:} The average gamma of this layer is:  0.7776875638377869
	
	The average solution for gamma of this layer is:  0.7549862461111381
	
	\item  \emph{Binary file:} \verb*|Diamond_record_6_100_dictionary_with_end_layer7_2024_02_23_09_28_54.b|. This file stores the gammas in this test.
	
\end{itemize}


\section{February 22-25 experiments}

\subsection{Find best open ReLU for layer 7 for normal 5x100, new pure y-constraints}

This experiment is to find the best open ReLU number for layer 7 normal 5x100 with new pure-y constraints constraints.

\vspace*{1ex}

The running code's file name is \verb*|DiamondLipschitz_V0p3_test.py|. And the partial output file name is \verb*|DL_V0p3_layer7_find_Best_open_number.txt,DL_V0p3_layer7_find_Best_open_number2.txt,DL_V0p3_layer7_find_Best_open_number3.txt,DL_V0p3_layer7_find_Best_open_number4.txt|.  It is based on the new pure y-constraints, use MILP model to compute the gamma of layer 7 with different open ReLU numbers.

\subsubsection*{Parameters.}

\begin{itemize}
	\item\emph{Experiments Id}: 022500102024
	
	\item\emph{Network:} 6x100 MNIST normal. 
	
	\item\emph{Image:} 144 (meaningless).
	
	\item\emph{Epsilon $\varepsilon$:} 0.001.
	
	\item\emph{Timeout:} No global timeout. The loop timeout for $\gamma$ is 600s with 12 loops at most.
	
	\item\emph{Open $\ReLU$ number:} Open 30, 33, $\cdots$, 72 ReLU nodes for each node (in 3 tests).
	
	\item\emph{Processes:} 20 processes in parallel. Do node 0 to 19 each 5 cases.
	
	\item\emph{Read binary files:} Read \verb*|Diamond_record_6_100_dictionary_with_end_layer7_2024_02_23_09_28_54.b|; this file stores all alpha beta gamma of nodes of all layers for the same network,and the data of gamma of layer 5 using the latest method. 
\end{itemize}


\subsubsection*{Technical Sketch.}

We will use the following new constraints, and keep the old variables and constraints (will not use them at present).

The new constraints are: \begin{align*}
	\hat{y}_i \leq a \gamma_i \hspace*{2ex} &\wedge \hspace*{2ex}\hat{y} \geq y_i - a \gamma_i\\
	\hat{y}_i \geq (a-1) \gamma_i  \hspace*{2ex} &\wedge \hspace*{2ex} \hat{y} \leq y_i + (1-a) \gamma_i,
\end{align*} Here, $y_i$ is the variable that represents $x_i-x'_i$, $\hat{y}_i$ represents $\hat{x}_i-\hat{x}'_i$, $a$ is a binary variable, $\gamma_i$ is the upper bound of $x_i-x'_i$.



\subsubsection*{Results.}

Not completed. So here is the summary of the partial results.

\begin{itemize}
	\item \emph{Log:} \verb*|DL_V0p3_layer7_find_Best_open_number.txt,DL_V0p3_layer7_find_Best_open_number2.txt,DL_V0p3_layer7_find_Best_open_number3.txt,DL_V0p3_layer7_find_Best_open_number4.txt|.
	
	\item \emph{Total time:} 
	
	\item \emph{Key results:}  $\gamma$ for different open numbers are
	
\end{itemize}

\end{document}


